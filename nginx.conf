events {

}

http {
    upstream meus_sites {
        #least_conn; #Altera o algoritmo para o least connections (servidor com menos conexões) ao invés do Round-Robin (padrão)

        server 127.0.0.1:5001;
        server 127.0.0.1:5002;

        #Weighted Round Robin
        #server 127.0.0.1:5001 weight=2;
        #server 127.0.0.1:5002 weight=1;
    }

    # Servidor para o balanceamento de carga
    server {
        listen 4000;

        location / {
            proxy_pass http://meus_sites;
        }
    }

    # Servidor simulando o site1. Aqui o nginx trabalha como server do site
    server {
        listen 5001;
        server_name localhost;

        root /Users/leo/DEV/load-balancer/site1; #diretório linux
        #root C:/site1; #diretório windows
        index index.html;
    }

    # Servidor simulando o site2. Aqui o nginx trabalha como server do site
    server {
        listen 5002;
        server_name localhost;

        root /Users/leo/DEV/load-balancer/site2; #diretório linux 
        #root C:/site2; #diretório windows
        index index.html;
    }
}